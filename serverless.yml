service: chris-hutchinson-svelte

provider:
  name: aws
  runtime: nodejs6.10
  stage: ${opt:stage, self:custom.stage}
  region: ${opt:region, self:custom.region}
  profile: ${opt:profile}
  environment:
    STATIC_RESOURCE_DOMAIN: ${file(./config/${self:provider.stage}.env.yml):static_domain}

functions:
  app:
    handler: handler.app
    events:
      - http:
          path: /
          method: get
      - http:
          path: /index.html
          method: get
  file:
    handler: handler.file
    events:
      - http:
          path: /app.js
          method: get
      - http:
          path: /sw.js
          method: get
      - http:
          path: /main.css
          method: get
      - http:
          path: /manifest.json
          method: get

package:
  exclude:
    - node_modules/babel-core/**
    - node_modules/babel-loader/**
    - node_modules/babel-plugin-external-helpers/**
    - node_modules/babel-plugin-*/**
    - node_modules/babel-preset-env/**
    - node_modules/rollup/**
    - node_modules/rollup-plugin-babel/**
    - node_modules/rollup-plugin-copy/**
    - node_modules/rollup-plugin-livereload/**
    - node_modules/rollup-plugin-serve/**
    - node_modules/rollup-plugin-svelte/**
    - node_modules/rollup-plugin-uglify/**
    - node_modules/rollup-watch/**
    - node_modules/serverless-offline/**
    - node_modules/serverless-plugin-custom-domain/**
    - node_modules/svelte-loader/**
    - node_modules/uglifyjs-webpack-plugin/**
    - node_modules/webpack/**

custom:
  stage: local
  region: eu-west-1

plugins:
  - serverless-offline
  - serverless-plugin-custom-domain